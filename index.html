<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />

  <!-- Fullscreen / signage optimisation -->
  <meta name="viewport"
        content="width=device-width,
                 height=device-height,
                 initial-scale=1,
                 maximum-scale=1,
                 user-scalable=no,
                 viewport-fit=cover" />

  <!-- Helps when launched from "Add to Home Screen" -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#000000" />

  <title>NXT Interactive – AI Concierge</title>

  <style>
    /* Hard reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;             /* stop scrolling */
      background: #000;
      touch-action: none;           /* reduce gesture UI */
      -webkit-user-select: none;
      user-select: none;
    }

    /* Fullscreen container for D-ID */
    #did-target {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
    }

    /* “Tap to start” overlay to trigger fullscreen (required by browsers) */
    #fs-overlay {
      position: fixed;
      inset: 0;
      z-index: 999999;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.25);
      color: #fff;
      font-family: Arial, sans-serif;
      font-size: 18px;
      text-align: center;
      padding: 24px;
      cursor: pointer;
      touch-action: manipulation;
    }

    /* Hidden debug area (enable if needed) */
    #debug {
      position: fixed;
      left: 10px; bottom: 10px;
      z-index: 1000000;
      background: rgba(0,0,0,0.55);
      color: #fff;
      font-family: monospace;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 6px;
      display: none;
    }
  </style>
</head>

<body>

  <div id="did-target"></div>

  <!-- Fullscreen trigger overlay -->
  <div id="fs-overlay">Tap anywhere to start</div>

  <div id="debug"></div>

  <script>
    // ===== Fullscreen best-effort (requires user gesture on Android) =====
    async function requestFullscreen() {
      const el = document.documentElement;
      try {
        if (el.requestFullscreen) await el.requestFullscreen();
        else if (el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
      } catch (e) {
        // If blocked, continue without fullscreen; Holobox may already be immersive.
      }
    }

    function hideOverlay() {
      const o = document.getElementById('fs-overlay');
      if (o) o.remove();
    }

    async function startKioskExperience() {
      await requestFullscreen();
      hideOverlay();
    }

    // Trigger fullscreen on first interaction
    const overlay = document.getElementById('fs-overlay');
    overlay.addEventListener('click', startKioskExperience, { once: true });
    overlay.addEventListener('touchend', startKioskExperience, { once: true });

    // Also attempt fullscreen on load (may be ignored by browser)
    window.addEventListener('load', () => { requestFullscreen(); });

    // Re-request fullscreen if focus returns (helps after dialogs)
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden) requestFullscreen();
    });

    // Prevent accidental zoom gestures
    document.addEventListener('gesturestart', (e) => e.preventDefault());
    document.addEventListener('gesturechange', (e) => e.preventDefault());
    document.addEventListener('gestureend', (e) => e.preventDefault());

    // ===== Simple watchdog: reload if page seems stalled =====
    // (Adjust timings if you want.)
    let lastHeartbeat = Date.now();
    setInterval(() => {
      // If nothing has updated for 3 minutes, reload
      if (Date.now() - lastHeartbeat > 180000) location.reload();
    }, 30000);

    // Mark "alive" every 20s
    setInterval(() => { lastHeartbeat = Date.now(); }, 20000);
  </script>

  <!-- Your D-ID embed (FULL mode into fullscreen div) -->
  <script type="module"
      src="https://agent.d-id.com/v2/index.js"
      data-mode="full"
      data-client-key="Z29vZ2xlLW9hdXRoMnwxMDQyNTc4MzMwMzQxNjM5MDE1OTc6X3pLLXUzdjVtOE54TVN0dWswNGhj"
      data-agent-id="v2_agt_-6mmEs_-"
      data-name="did-agent"
      data-monitor="true"
      data-target-id="did-target">
  </script>

</body>
</html>
